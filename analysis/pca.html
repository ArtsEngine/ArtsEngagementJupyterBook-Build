

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Principal Components Analysis &#8212; The Arts Engagement Project at The University of Michigan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://artsengagementproject.site/analysis/pca.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis of Principal Components x Demographic Factors" href="pca-demographics.html" />
    <link rel="prev" title="Dictionaries of Language Patterns" href="dictionaries.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://artsengagementproject.site/analysis/pca.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Principal Components Analysis" />
<meta property="og:description" content="Principal Components Analysis  We used a Principle Components Analysis (PCA) in R (‘prcomp’ function) to integrate multiple variables and conduct an analysis fo" />
<meta property="og:image"       content="https://artsengagementproject.site/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Arts Engagement Project at The University of Michigan</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   The Arts Engagement Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Overview
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/background.html">
   Project Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/studydesign.html">
   Study Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/presentations.html">
   Presentations and Publications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/references.html">
   References &amp; Works Cited
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Insights
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/insights.html">
   Insights Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/descriptivestats.html">
   Descriptive Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/learning-outcomes.html">
   Learning Outcomes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/barriers.html">
   Barriers to Involvement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/othergrowth.html">
   Personal Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/feel.html">
   Emotional Impact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/development.html">
   Developmental Role
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/role.html">
   College Experience
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/experience/tree.html">
   Transformative Experiences
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Analyses
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   Methods Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="topics.html">
   Topic Modeling and Interpretation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stm-workflow.html">
   Structural Topic Model Workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries of Language Patterns
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Principal Components Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pca-demographics.html">
   Analysis of Principal Components x Demographic Factors
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/analysis/pca.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/analysis/pca.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/analysis/pca.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="principal-components-analysis">
<h1>Principal Components Analysis<a class="headerlink" href="#principal-components-analysis" title="Permalink to this headline">¶</a></h1>
<p>We used a Principle Components Analysis (PCA) in R (‘prcomp’ function) to integrate multiple variables and conduct an analysis for each question and set of responses. PCA is a multivariate statistical technique that extracts important information about the inter-correlations of multiple variables and re-represents that information as new variables called principle components. These new principle components can then be used to show the similarity and graphic relationships between variables as a way of exploring the data. Because PCA condenses multiple variables into fewer dimensions, the new principle components may also be used to integrate new descriptions of the combined variables. These reified principle components may then be used as covariates to estimate relationships with other variables such as demographic factors.</p>
<p>Twenty-seven dictionary-based variables (LIWC, AIC, and Docuscope) were not relevant and were excluded from the analysis, leaving a total of 221 dictionary-based variables in the PCA. This was in addition to the measures of topic prevalence, which each had different numbers of topic variables depending on the question/response type. In order to remove variables with high numbers of 0s (no observations), we set a 0.3 maximum threshold, leaving variable columns with 70% or more observations in the analysis. The number of responses and variables included for each question in the analysis are provided in Table 1. Because of the different scales used by the different dictionaries and topic measures (for example, topic prevalence is 0-1 while AIC is measured on a scale from 1-7), the PCA was based on a correlation matrix. The data were also centered around zero and rotated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#install.packages(&quot;corrplot&quot;)</span>
<span class="c1">#install.packages(&quot;ggplot2&quot;)</span>
<span class="c1">#install.packages(&quot;plotly&quot;)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;factoextra&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;FactoMineR&quot;</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>   <span class="c1"># plotting;</span>
<span class="nf">library</span><span class="p">(</span><span class="n">plotly</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">haven</span><span class="p">)</span>     <span class="c1"># SPSS/.sav file import</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>     <span class="c1"># data manipulation</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;corrplot&quot;</span><span class="p">)</span><span class="c1">#</span>
<span class="nf">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span>   <span class="c1"># string manipulation</span>
<span class="nf">library</span><span class="p">(</span><span class="n">labelled</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;FactoMineR&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;factoextra&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#data &lt;- read.csv(&#39;pcadata.csv&#39;)</span>
<span class="nf">load</span><span class="p">(</span><span class="n">file</span> <span class="o">=</span> <span class="s">&#39;merged_artsengagement.rda&#39;</span><span class="p">)</span>
<span class="nf">ls</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><ol class=list-inline>
	<li>'data'</li>
	<li>'df'</li>
</ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">&lt;-</span> <span class="n">df</span>
<span class="c1">#print the dimension of the dataframe</span>
<span class="nf">dim</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><ol class=list-inline>
	<li>4828</li>
	<li>7288</li>
</ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">stripnames</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">question</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">data</span> <span class="o">&lt;-</span> <span class="n">data</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span><span class="nf">starts_with</span><span class="p">(</span><span class="n">question</span><span class="p">))</span>
    <span class="n">varnames</span> <span class="o">&lt;-</span> <span class="nf">names</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">newnames</span> <span class="o">&lt;-</span> <span class="n">varnames</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="m">2</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">varnames</span><span class="p">)))</span> <span class="p">{</span>
        <span class="n">newnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nf">substr</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nf">gregexpr</span><span class="p">(</span><span class="s">&quot;\\.\\.&quot;</span><span class="p">,</span> <span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">])[[</span><span class="m">1</span><span class="p">]][</span><span class="m">1</span><span class="p">]</span><span class="m">+2</span><span class="p">,</span> <span class="nf">nchar</span><span class="p">(</span><span class="n">varnames</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="p">}</span>
    <span class="nf">names</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">newnames</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">mergeQuestion</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">question</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">if</span><span class="p">(</span><span class="nf">substr</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">question</span> <span class="o">&lt;-</span> <span class="nf">substr</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="nf">nchar</span><span class="p">(</span><span class="n">question</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="c1"># if you&#39;re aware of other prefixes, add them here</span>
    <span class="n">yrs</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;fl_&#39;</span><span class="p">,</span><span class="s">&#39;f1_&#39;</span><span class="p">,</span><span class="s">&#39;f2_&#39;</span><span class="p">,</span><span class="s">&#39;so_&#39;</span><span class="p">,</span><span class="s">&#39;jr_&#39;</span><span class="p">,</span><span class="s">&#39;sr_&#39;</span><span class="p">,</span><span class="s">&#39;sl_&#39;</span><span class="p">)</span>
    <span class="n">mergeddf</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">()</span>
    <span class="nf">for</span><span class="p">(</span><span class="n">yr</span> <span class="n">in</span> <span class="n">yrs</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">qyr</span> <span class="o">&lt;-</span> <span class="nf">paste0</span><span class="p">(</span><span class="n">yr</span><span class="p">,</span> <span class="n">question</span><span class="p">)</span>
        <span class="nf">if</span><span class="p">(</span><span class="n">data</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span><span class="nf">starts_with</span><span class="p">(</span><span class="n">qyr</span><span class="p">))</span> <span class="o">%&gt;%</span> <span class="n">ncol</span> <span class="o">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span> <span class="n">next</span> <span class="p">}</span>
        <span class="n">tempdf</span> <span class="o">&lt;-</span> <span class="nf">stripnames</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">qyr</span><span class="p">)</span>
        <span class="nf">names</span><span class="p">(</span><span class="n">tempdf</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="n">question</span>
        <span class="n">mergeddf</span> <span class="o">&lt;-</span> <span class="nf">bind_rows</span><span class="p">(</span><span class="n">mergeddf</span><span class="p">,</span> <span class="n">tempdf</span><span class="p">)</span>        
    <span class="p">}</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">mergeddf</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">stripVars</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">#remove irrelavant variables</span>
    <span class="n">removenames</span> <span class="o">&lt;-</span> <span class="nf">names</span><span class="p">(</span><span class="n">data</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span><span class="nf">matches</span><span class="p">(</span><span class="s">&quot;AIC..Words|AIC..IC_Differentiation|AIC..IC_Integration|AIC..DIAL_Differentiation|AIC..DIAL_Integration|AIC..ELAB_Differentiation|AIC..ELAB_Integration|docuscope..OralCues|docuscope..DialogCues|docuscope..XWordTokens|docuscope..XPunctuationTokens|docuscope..XTokens|LIWC..WC|LIWC..Sixltr|LIWC..Dic|LIWC..WPS|LIWC..swear|LIWC..netspeak|LIWC..assent|LIWC..nonflu|LIWC..filler|LIWC..AllPunc|LIWC..Period|LIWC..Comma|LIWC..Colon|LIWC..SemiC|LIWC..QMark|LIWC..Exclam|LIWC..Dash|LIWC..Quote|LIWC..Apostro|LIWC..Parenth|LIWC..OtherP&quot;</span><span class="p">)))</span>
    <span class="n">data</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="p">[</span> <span class="p">,</span> <span class="o">!</span><span class="nf">names</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%in%</span> <span class="n">removenames</span><span class="p">]</span>
    <span class="nf">return</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">#example input for parameter question: &quot;sr_career&quot;</span>
<span class="c1">#threshold: set the threshold for cos2. only variables with cos2&gt; threshold will be kept in biplots</span>
<span class="c1">#percent: set the percentage of 0 in a column; columns with percentage of 0 values &gt; percent will be removed</span>
<span class="n">pca_biplot</span> <span class="o">&lt;-</span> <span class="nf">function</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="n">threshold</span><span class="p">,</span><span class="n">percent</span><span class="p">)</span> <span class="p">{</span>
    
    
    <span class="nf">if</span><span class="p">(</span><span class="nf">substr</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;_&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">question</span> <span class="o">&lt;-</span> <span class="nf">substr</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="nf">nchar</span><span class="p">(</span><span class="n">question</span><span class="p">))</span>
    <span class="p">}</span>
    
    <span class="c1"># select columns relevant to the question</span>
    <span class="n">data_subset</span> <span class="o">&lt;-</span> <span class="nf">mergeQuestion</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">question</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">stripVars</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">data_subset</span><span class="p">))</span>
    <span class="c1">#create file for eigenvales and output</span>
    <span class="n">eigfile</span> <span class="o">&lt;-</span> <span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_eigenvalues.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
    <span class="nf">sink</span><span class="p">(</span><span class="n">eigfile</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>       
    
    <span class="c1">#remove rows with no response</span>
    <span class="n">data_subset</span> <span class="o">&lt;-</span> <span class="n">data_subset</span><span class="p">[</span><span class="nf">complete.cases</span><span class="p">(</span><span class="n">data_subset</span><span class="p">),]</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">data_subset</span><span class="p">))</span>
    <span class="c1"># replace NULL with 0</span>
    <span class="c1"># this shouldnt be necessary -- investigate if so</span>
    <span class="c1"># data_subset[is.na(data_subset)] &lt;- 0</span>

    <span class="c1">#remove columns with percentage of 0 values &gt; percent </span>
    <span class="n">data_subset</span> <span class="o">&lt;-</span> <span class="n">data_subset</span><span class="p">[</span> <span class="nf">lapply</span><span class="p">(</span> <span class="n">data_subset</span><span class="p">,</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="m">0</span><span class="p">)</span> <span class="o">/</span> <span class="nf">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">percent</span> <span class="p">]</span>

    <span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">data_subset</span><span class="p">))</span>

    <span class="nf">print</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">data_subset</span><span class="p">))</span>

    <span class="c1">#scale all the variables</span>
    <span class="n">data_subset</span><span class="p">[,</span> <span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">data_subset</span><span class="p">[,</span> <span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">)])</span>

    <span class="c1">#create new dataframe pcadata to store scaled variables</span>
    <span class="n">pcadata</span><span class="o">&lt;-</span><span class="n">data_subset</span><span class="p">[,</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span>



    <span class="c1">#remove columns that only have NULL; columns that only have 0 after scaling will become NULL</span>
    <span class="n">pcadata2</span><span class="o">=</span><span class="nf">Filter</span><span class="p">(</span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">!</span><span class="nf">all</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">pcadata</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="nf">dim</span><span class="p">(</span><span class="n">pcadata2</span><span class="p">))</span>


    <span class="c1">#fit PCA uses correlatio matrix, rotation, centered</span>
    <span class="n">pca.fit</span> <span class="o">&lt;-</span> <span class="nf">prcomp</span><span class="p">(</span><span class="n">pcadata2</span><span class="p">,</span> <span class="n">retx</span><span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
    <span class="n">eig.val</span> <span class="o">&lt;-</span> <span class="nf">get_eigenvalue</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">)</span>


    <span class="c1">#get variable contributions</span>
    <span class="n">var</span> <span class="o">&lt;-</span> <span class="nf">get_pca_var</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">)</span>
    <span class="c1">#print(var$contrib)</span>
    <span class="c1">#print(var$coord)</span>
    <span class="c1">#print(pca.fit)</span>

 
    <span class="c1"># Print Eigenvalues and variable contributions and close sink</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">eig.val</span><span class="p">)</span>

    <span class="nf">sink</span><span class="p">(</span><span class="n">append</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;message&quot;</span><span class="p">)</span>
    <span class="nf">sink</span><span class="p">()</span>

    <span class="c1"># Export into a TXT file</span>
    <span class="nf">write.infile</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_pca_results.txt&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&quot;\t&quot;</span><span class="p">)</span>


    <span class="c1">#print screeplot              </span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_screeplot.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>    
    <span class="n">screeplot</span><span class="o">=</span><span class="nf">fviz_eig</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">addlabels</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">50</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">screeplot</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>

    <span class="c1">#make biplot for PC1&amp;2               </span>
    <span class="n">p12</span><span class="o">=</span><span class="nf">fviz_pca_var</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">col.var</span> <span class="o">=</span> <span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">alpha.var</span><span class="o">=</span><span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">select.var</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">cos2</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">),</span>
                 <span class="n">gradient.cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;goldenrod1&quot;</span><span class="p">,</span> <span class="s">&quot;firebrick2&quot;</span><span class="p">,</span> <span class="s">&quot;navy&quot;</span><span class="p">),</span> 
                 <span class="n">repel</span> <span class="o">=</span> <span class="kc">TRUE</span> <span class="c1"># Avoid text overlapping</span>
                 <span class="p">)</span><span class="o">+</span> <span class="nf">xlim</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ylim </span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
                    
                    
    <span class="c1">#make biplot for PC3&amp;4              </span>
    <span class="n">p34</span><span class="o">=</span><span class="nf">fviz_pca_var</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="n">col.var</span> <span class="o">=</span> <span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">alpha.var</span><span class="o">=</span><span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">select.var</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">cos2</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">),</span>
                 <span class="n">gradient.cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;goldenrod1&quot;</span><span class="p">,</span> <span class="s">&quot;firebrick2&quot;</span><span class="p">,</span> <span class="s">&quot;navy&quot;</span><span class="p">),</span> 
                 <span class="n">repel</span> <span class="o">=</span> <span class="kc">TRUE</span> <span class="c1"># Avoid text overlapping</span>
                 <span class="p">)</span><span class="o">+</span> <span class="nf">xlim</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ylim </span><span class="p">(</span><span class="m">-1</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>

    <span class="c1">#print biplot                </span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_biplot12.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">p12</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>
                    
    <span class="c1">#print biplot                </span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_biplot34.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">p34</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>

    <span class="c1">#print charts of variable contrib and cos2</span>

    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_corr_cos2_viz.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">corrcos2viz</span> <span class="o">&lt;-</span> <span class="nf">corrplot</span><span class="p">(</span><span class="n">var</span><span class="o">$</span><span class="n">cos2</span><span class="p">,</span> <span class="n">is.corr</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">tl.cex</span> <span class="o">=</span> <span class="n">.</span><span class="m">5</span><span class="p">)</span>   
    <span class="nf">print</span><span class="p">(</span><span class="n">corrcos2viz</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>

    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_corr_contrib_viz.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">corrcontribviz</span> <span class="o">&lt;-</span> <span class="nf">corrplot</span><span class="p">(</span><span class="n">var</span><span class="o">$</span><span class="n">contrib</span><span class="p">,</span> <span class="n">is.corr</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">tl.cex</span> <span class="o">=</span> <span class="n">.</span><span class="m">5</span><span class="p">)</span>    
    <span class="nf">print</span><span class="p">(</span><span class="n">corrcontribviz</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>


    <span class="c1"># Contributions of variables to PC1</span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_contributionPC1.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">c1</span><span class="o">=</span><span class="nf">fviz_contrib</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span>              
    <span class="nf">dev.off</span><span class="p">()</span>
    <span class="c1"># Contributions of variables to PC2</span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_contributionPC2.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">c2</span><span class="o">=</span><span class="nf">fviz_contrib</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c2</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>
    <span class="c1"># Contributions of variables to PC3</span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_contributionPC3.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">c3</span><span class="o">=</span><span class="nf">fviz_contrib</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c3</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>
    <span class="c1"># Contributions of variables to PC4</span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_contributionPC4.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">c4</span><span class="o">=</span><span class="nf">fviz_contrib</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c4</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>
    <span class="c1"># Contributions of variables to PC5</span>
    <span class="nf">pdf</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_contributionPC5.pdf&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
    <span class="n">c5</span><span class="o">=</span><span class="nf">fviz_contrib</span><span class="p">(</span><span class="n">pca.fit</span><span class="p">,</span> <span class="n">choice</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">top</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">c5</span><span class="p">)</span>
    <span class="nf">dev.off</span><span class="p">()</span>



    <span class="c1">###### interactive pca plot</span>
    <span class="c1">#add text response back to pcadata2</span>
    <span class="n">pcadata2</span><span class="o">$</span><span class="n">text</span><span class="o">&lt;-</span><span class="n">data_subset</span><span class="p">[[</span><span class="n">question</span><span class="p">]]</span>
    <span class="n">res.pca</span> <span class="o">&lt;-</span> <span class="nf">PCA</span><span class="p">(</span><span class="n">pcadata2</span><span class="p">[,</span><span class="o">!</span><span class="p">(</span><span class="nf">colnames</span><span class="p">(</span><span class="n">pcadata2</span><span class="p">)</span> <span class="o">%in%</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">))],</span> <span class="n">graph</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>

    <span class="c1">#make biplot with individual dots</span>
    <span class="n">test2</span><span class="o">&lt;-</span><span class="nf">fviz_pca_biplot</span><span class="p">(</span><span class="n">res.pca</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="n">geom</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;point&#39;</span><span class="p">,</span><span class="s">&#39;text&#39;</span><span class="p">),</span> <span class="n">col.ind</span> <span class="o">=</span> <span class="s">&quot;light blue&quot;</span><span class="p">,</span>
                    <span class="n">pointshape</span> <span class="o">=</span> <span class="m">19</span><span class="p">,</span> <span class="n">pointsize</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span><span class="n">alpha.ind</span> <span class="o">=</span> <span class="m">0.3</span><span class="p">,</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> 
                    <span class="n">alpha.var</span> <span class="o">=</span><span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">select.var</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">cos2</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">),</span>
                     <span class="n">col.var</span> <span class="o">=</span> <span class="s">&quot;cos2&quot;</span><span class="p">,</span><span class="n">gradient.cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">)</span>

                    <span class="p">)</span>
                    
                    
      <span class="c1">#labs(fill = &quot;identity&quot;)# Change legend title</span>

    <span class="c1">#add hover text</span>
    <span class="n">mytext</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">pcadata2</span><span class="o">$</span><span class="n">text</span><span class="p">)</span> 
    <span class="n">pp</span><span class="o">=</span><span class="nf">ggplotly</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">test2</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">800</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">800</span><span class="p">)</span>
    <span class="n">ppp</span><span class="o">=</span><span class="nf">style</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">mytext</span><span class="p">,</span><span class="n">hoverinfo</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="n">traces</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
    <span class="n">htmlwidgets</span><span class="o">::</span><span class="nf">saveWidget</span><span class="p">(</span><span class="nf">as_widget</span><span class="p">(</span><span class="n">ppp</span><span class="p">),</span> <span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_plotly12.html&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
                    
    <span class="n">test3</span><span class="o">&lt;-</span><span class="nf">fviz_pca_biplot</span><span class="p">(</span><span class="n">res.pca</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">),</span> <span class="n">geom</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;point&#39;</span><span class="p">,</span><span class="s">&#39;text&#39;</span><span class="p">),</span> <span class="n">col.ind</span> <span class="o">=</span> <span class="s">&quot;light blue&quot;</span><span class="p">,</span>
                    <span class="n">pointshape</span> <span class="o">=</span> <span class="m">19</span><span class="p">,</span> <span class="n">pointsize</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span><span class="n">alpha.ind</span> <span class="o">=</span> <span class="m">0.3</span><span class="p">,</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s">&quot;var&quot;</span><span class="p">,</span> 
                    <span class="n">alpha.var</span> <span class="o">=</span><span class="s">&quot;cos2&quot;</span><span class="p">,</span> <span class="n">select.var</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">cos2</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">),</span>
                     <span class="n">col.var</span> <span class="o">=</span> <span class="s">&quot;cos2&quot;</span><span class="p">,</span><span class="n">gradient.cols</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">)</span>

                    <span class="p">)</span>
                    
    <span class="c1">#add hover text</span>
    <span class="n">mytext</span><span class="o">=</span><span class="nf">paste</span><span class="p">(</span><span class="n">pcadata2</span><span class="o">$</span><span class="n">text</span><span class="p">)</span> 
    <span class="n">pp</span><span class="o">=</span><span class="nf">ggplotly</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">test3</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="m">800</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="m">800</span><span class="p">)</span>
    <span class="n">ppp</span><span class="o">=</span><span class="nf">style</span><span class="p">(</span><span class="n">pp</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="n">mytext</span><span class="p">,</span><span class="n">hoverinfo</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span> <span class="n">traces</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
    <span class="n">htmlwidgets</span><span class="o">::</span><span class="nf">saveWidget</span><span class="p">(</span><span class="nf">as_widget</span><span class="p">(</span><span class="n">ppp</span><span class="p">),</span> <span class="nf">paste</span><span class="p">(</span><span class="n">question</span><span class="p">,</span><span class="s">&quot;_plotly34.html&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="p">}</span>
                
            
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#example input for parameter question: &quot;career&quot;</span>
<span class="c1">#1st is threshold: set the threshold for cos2. only variables with cos2&gt; threshold will be kept in biplots</span>
<span class="c1">#2nd is percent: set the percentage of 0 in a column; columns with percentage of 0 values &gt; percent will be removedpca_biplot(&#39;barriers&#39;,0.3,0.4)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;career&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;development&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;othergrowth&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;society&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;role&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;barriers&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;feel&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;definition&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;aftercollege4&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;behavior2&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;change&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
<span class="nf">pca_biplot</span><span class="p">(</span><span class="s">&#39;childhood2&#39;</span><span class="p">,</span><span class="m">0.2</span><span class="p">,</span><span class="m">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./analysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="dictionaries.html" title="previous page">Dictionaries of Language Patterns</a>
    <a class='right-next' id="next-link" href="pca-demographics.html" title="next page">Analysis of Principal Components x Demographic Factors</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-44678143-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>