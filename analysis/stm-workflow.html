

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Structural Topic Model Workflow &#8212; The Arts Engagement Project at The University of Michigan</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://artsengagementproject.site/analysis/stm-workflow.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dictionaries of Language Patterns" href="dictionaries.html" />
    <link rel="prev" title="Topic Modeling and Interpretation" href="topics.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">


<!-- Opengraph tags -->
<meta property="og:url"         content="https://artsengagementproject.site/analysis/stm-workflow.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Structural Topic Model Workflow" />
<meta property="og:description" content="Structural Topic Model Workflow  Order of operations:  Preliminary structural topic model (STM) created with a number of topics decided by spectral initializati" />
<meta property="og:image"       content="https://artsengagementproject.site/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">The Arts Engagement Project at The University of Michigan</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   The Arts Engagement Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Project Overview
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/background.html">
   Project Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/studydesign.html">
   Study Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/presentations.html">
   Presentations and Publications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../overview/references.html">
   References &amp; Works Cited
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Insights
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/insights.html">
   Insights Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/descriptivestats.html">
   Descriptive Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/barriers.html">
   Barriers to Involvement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/othergrowth.html">
   Personal Growth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/feel.html">
   Emotional Impact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/development.html">
   Developmental Role
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/role.html">
   College Experience
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../insights/experience/tree.html">
   Transformative Experiences
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Analyses
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="methods.html">
   Methods Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="topics.html">
   Topic Modeling and Interpretation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Structural Topic Model Workflow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dictionaries.html">
   Dictionaries of Language Patterns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pca.html">
   Principal Components Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pca-demographics.html">
   Analysis of Principal Components x Demographic Factors
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/analysis/stm-workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/analysis/stm-workflow.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/analysis/stm-workflow.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preliminary-stm">
   Preliminary STM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nbclust-cluster-analysis">
   NbClust Cluster Analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#improved-stms">
   Improved STMs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outputting-stm-data">
     Outputting STM Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stm-refinement">
   STM Refinement
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="structural-topic-model-workflow">
<h1>Structural Topic Model Workflow<a class="headerlink" href="#structural-topic-model-workflow" title="Permalink to this headline">¶</a></h1>
<p>Order of operations:</p>
<ol class="simple">
<li><p>Preliminary structural topic model (STM) created with a number of topics decided by spectral initialization (k=0).</p></li>
<li><p>Clustering algorithms are run over the prelimary STMs’ topic-prevalence by document matrix to find a number of topics that better fits the data.</p></li>
<li><p>STM data saved as JSON to be used with the visualization webapp.</p></li>
<li><p>Manual STM refinement.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># load libraries</span>
<span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">stm</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">jsonlite</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">doMC</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">foreach</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">NbClust</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># load data</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&#39;../data/tidy_questions_best.Rda&#39;</span><span class="p">)</span>
<span class="c1"># load helper script</span>
<span class="nf">source</span><span class="p">(</span><span class="s">&#39;../github/stmjson.R&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set number of cores to use on following computations</span>
<span class="nf">registerDoMC</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
<span class="c1"># Set seed</span>
<span class="n">seed</span> <span class="o">=</span> <span class="m">123</span> <span class="c1"># variable to be used later on</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="preliminary-stm">
<h2>Preliminary STM<a class="headerlink" href="#preliminary-stm" title="Permalink to this headline">¶</a></h2>
<p>Used to find baseline topic number using spectral initialization (K=0)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># STM does not produce meaningful clusters for these questions and are best removed.</span>
<span class="n">questions</span> <span class="o">&lt;-</span> <span class="n">questions</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">&lt;-</span> <span class="nf">Sys.time</span><span class="p">()</span>
<span class="n">verbosity</span> <span class="o">&lt;-</span> <span class="kc">FALSE</span>
<span class="n">default_stop_words</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;art&#39;</span><span class="p">,</span><span class="s">&#39;arts&#39;</span><span class="p">)</span>

<span class="n">procs</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">textProcessor</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">n</span><span class="p">]][[</span><span class="m">1</span><span class="p">]],</span>
                                                                  <span class="n">metadata</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">n</span><span class="p">]][</span><span class="m">2</span><span class="p">],</span>
                                                                  <span class="n">customstopwords</span> <span class="o">=</span> <span class="n">default_stop_words</span><span class="p">,</span>
                                                                  <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbosity</span><span class="p">)</span>

<span class="n">docs</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">prepDocuments</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span> 
                                                                 <span class="n">vocab</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">vocab</span><span class="p">,</span> <span class="n">meta</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">meta</span><span class="p">,</span>
                                                                 <span class="n">lower.thresh</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">procs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span> <span class="o">%&gt;%</span>
                                                                                       <span class="n">length</span> <span class="o">&gt;</span> <span class="m">1000</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span>
                                                                 <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbosity</span><span class="p">)</span>

<span class="n">prelim_stms</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">stm</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
                                                               <span class="n">vocab</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">vocab</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> 
                                                               <span class="n">data</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">meta</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbosity</span><span class="p">,</span>
                                                               <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

<span class="n">time_taken</span> <span class="o">&lt;-</span> <span class="nf">Sys.time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="n">time_taken</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time difference of 2.267745 mins
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="nbclust-cluster-analysis">
<h2>NbClust Cluster Analysis<a class="headerlink" href="#nbclust-cluster-analysis" title="Permalink to this headline">¶</a></h2>
<p>Used to find rough estimates of the best number of topics (clusters) for each question. The preliminary spectral initialization tends to overestimate the best number of topics for intuitive sense-making of the data as a whole, so clustering algorithms can then find topics likely to co-occur with each other and recommend a number of topics collapsing those groups into single topics. By using many clustering algorithms using varying techniques we can</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pcas</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">prelim_stms</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">prcomp</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">prelim_stms</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">theta</span><span class="p">),</span> <span class="n">scale.</span> <span class="o">=</span> <span class="bp">T</span><span class="p">)</span>

<span class="n">nbcs</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">pcas</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">NbClust</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="nf">select</span><span class="p">(</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">pcas</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">x</span><span class="p">),</span>
                                                                     <span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="n">prelim_stms</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">settings</span><span class="o">$</span><span class="n">dim</span><span class="o">$</span><span class="n">K</span> <span class="o">-</span> <span class="m">5</span><span class="p">)),</span>
                                                       <span class="n">diss</span> <span class="o">=</span> <span class="nf">daisy</span><span class="p">(</span><span class="n">pcas</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">x</span><span class="p">),</span>
                                                       <span class="n">distance</span><span class="o">=</span><span class="kc">NULL</span><span class="p">,</span>
                                                       <span class="n">min.nc</span><span class="o">=</span><span class="m">3</span><span class="p">,</span>
                                                       <span class="n">max.nc</span><span class="o">=</span><span class="m">27</span><span class="p">,</span>
                                                       <span class="n">method</span><span class="o">=</span><span class="s">&#39;complete&#39;</span><span class="p">,</span>
                                                       <span class="n">index</span><span class="o">=</span><span class="s">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** : The Hubert index is a graphical method of determining the number of clusters.
                In the plot of Hubert index, we seek a significant knee that corresponds to a 
                significant increase of the value of the measure i.e the significant peak in Hubert
                index second differences plot. 
 
</pre></div>
</div>
<img alt="../_images/stm-workflow_8_1.png" src="../_images/stm-workflow_8_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** : The D index is a graphical method of determining the number of clusters. 
                In the plot of D index, we seek a significant knee (the significant peak in Dindex
                second differences plot) that corresponds to a significant increase of the value of
                the measure. 
 
******************************************************************* 
* Among all indices:                                                
* 9 proposed 3 as the best number of clusters 
* 2 proposed 4 as the best number of clusters 
* 2 proposed 7 as the best number of clusters 
* 1 proposed 12 as the best number of clusters 
* 3 proposed 13 as the best number of clusters 
* 1 proposed 19 as the best number of clusters 
* 1 proposed 20 as the best number of clusters 
* 1 proposed 21 as the best number of clusters 
* 2 proposed 22 as the best number of clusters 
* 1 proposed 25 as the best number of clusters 
* 1 proposed 27 as the best number of clusters 

                   ***** Conclusion *****                            
 
* According to the majority rule, the best number of clusters is  3 
 
 
******************************************************************* 
</pre></div>
</div>
<img alt="../_images/stm-workflow_8_3.png" src="../_images/stm-workflow_8_3.png" />
</div>
</div>
<p>This code picks the best number of topics (clusters) for each dataset based on popular vote by the clustering algorithms (excluding the filtered methods). The methods filtered out consistently choose the lowest number of clusters in the provided range and are best not considered for our purposes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">k_candidates</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="n">nbcs</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">num_clust</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">nbcs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">Best.nc</span> <span class="o">%&gt;%</span> <span class="n">t</span> <span class="o">%&gt;%</span> <span class="n">rownames</span><span class="p">,</span>
               <span class="n">nc</span><span class="o">=</span><span class="n">nbcs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">Best.nc</span> <span class="o">%&gt;%</span> <span class="n">t</span> <span class="o">%&gt;%</span> <span class="nf">as.data.frame</span><span class="p">()</span> <span class="o">%&gt;%</span> <span class="nf">pull</span><span class="p">(</span><span class="m">1</span><span class="p">))</span> <span class="o">%&gt;%</span> 
                    <span class="nf">filter</span><span class="p">(</span><span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Cindex&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;DB&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Silhouette&#39;</span> <span class="o">&amp;</span>
                           <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Duda&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;PseudoT2&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Beale&#39;</span> <span class="o">&amp;</span>
                           <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;McClain&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Hubert&#39;</span> <span class="o">&amp;</span> <span class="n">method</span> <span class="o">!=</span> <span class="s">&#39;Dindex&#39;</span><span class="p">)</span>
    <span class="n">num_clust</span> <span class="o">%&lt;&gt;%</span> <span class="nf">pull</span><span class="p">(</span><span class="m">2</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">table</span> <span class="o">%&gt;%</span> <span class="n">data.frame</span> <span class="o">%&gt;%</span> <span class="nf">arrange</span><span class="p">(</span><span class="o">-</span><span class="n">Freq</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">pull</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
    <span class="n">k_candidates</span> <span class="o">%&lt;&gt;%</span> <span class="nf">c</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">num_clust</span><span class="p">)[</span><span class="n">num_clust</span><span class="p">]</span> <span class="o">%&gt;%</span> <span class="n">as.numeric</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Save STM settings for easy regeneration</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">stm_settings</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">()</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="p">{</span>
    <span class="n">stm_settings</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">stopwords</span> <span class="o">&lt;-</span> <span class="n">default_stop_words</span>
    <span class="n">stm_settings</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">ntopics</span> <span class="o">&lt;-</span> <span class="n">k_candidates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">stm_settings</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">seed</span> <span class="o">&lt;-</span> <span class="n">seed</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="improved-stms">
<h2>Improved STMs<a class="headerlink" href="#improved-stms" title="Permalink to this headline">¶</a></h2>
<p>Using NbClust recommended numbers of topics (stored in the array k_candidates).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="o">&lt;-</span> <span class="nf">Sys.time</span><span class="p">()</span>
<span class="n">verbosity</span> <span class="o">&lt;-</span> <span class="kc">FALSE</span>

<span class="n">improved_stms</span> <span class="o">&lt;-</span> <span class="nf">foreach</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="o">%dopar%</span> <span class="nf">stm</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
                                                                 <span class="n">vocab</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">vocab</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">k_candidates</span><span class="p">[</span><span class="n">n</span><span class="p">],</span>
                                                                 <span class="n">data</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">meta</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">verbosity</span><span class="p">,</span>
                                                                 <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>

<span class="n">time_taken</span> <span class="o">&lt;-</span> <span class="nf">Sys.time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="n">time_taken</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Time difference of 18.36213 secs
</pre></div>
</div>
</div>
</div>
<div class="section" id="outputting-stm-data">
<h3>Outputting STM Data<a class="headerlink" href="#outputting-stm-data" title="Permalink to this headline">¶</a></h3>
<p>To be used with the webapp (which can be downloaded from https://github.com/ArtsEngine/arts-engagement-project/blob/master/STM_Tree_Viz.html)</p>
<p>The webapp will load the json named data.js in the same directory, so make a copy of any of the outputted data and rename it data.js, and open the html file in your browser to view.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">question_names</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="n">questions</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">question_names</span> <span class="o">%&lt;&gt;%</span> <span class="nf">c</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">questions</span><span class="p">[[</span><span class="n">i</span><span class="p">]][</span><span class="m">1</span><span class="p">]))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set directory to save to</span>
<span class="n">directory</span> <span class="o">=</span> <span class="s">&#39;./&#39;</span>

<span class="nf">for </span><span class="p">(</span><span class="n">n</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">questions</span><span class="p">)))</span> <span class="p">{</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">threshold</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0.1</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">possible_error</span> <span class="o">&lt;-</span> <span class="nf">tryCatch</span><span class="p">(</span>
          <span class="nf">create_json</span><span class="p">(</span>
                <span class="n">stm</span> <span class="o">=</span> <span class="n">improved_stms</span><span class="p">[[</span><span class="n">n</span><span class="p">]],</span>
                <span class="n">documents_raw</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">n</span><span class="p">]][</span><span class="n">question_names</span><span class="p">[</span><span class="n">n</span><span class="p">]]</span> <span class="o">%&gt;%</span> <span class="nf">slice</span><span class="p">(</span><span class="o">-</span><span class="n">procs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">docs.removed</span><span class="p">)</span> <span class="o">%&gt;%</span> 
                                                                       <span class="nf">slice</span><span class="p">(</span><span class="o">-</span><span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">docs.removed</span><span class="p">)</span> <span class="o">%&gt;%</span> 
                                                                       <span class="n">pull</span><span class="p">,</span>
                <span class="n">documents_matrix</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">n</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
                <span class="n">column_name</span> <span class="o">=</span> <span class="n">question_names</span><span class="p">[[</span><span class="n">n</span><span class="p">]],</span>
                <span class="n">title</span> <span class="o">=</span> <span class="nf">names</span><span class="p">(</span><span class="n">questions</span><span class="p">[</span><span class="n">n</span><span class="p">]),</span>
                <span class="n">clustering_thresh</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">,</span>
                <span class="n">verbose</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
                <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
          <span class="p">),</span> <span class="n">error</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="n">msg</span><span class="p">)</span>
        <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">inherits</span><span class="p">(</span><span class="n">possible_error</span><span class="p">,</span> <span class="s">&quot;error&quot;</span><span class="p">))</span> <span class="n">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing hierarchical topic clustering ... 
Generating JSON representation of the model ... 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="stm-refinement">
<h2>STM Refinement<a class="headerlink" href="#stm-refinement" title="Permalink to this headline">¶</a></h2>
<p>Use this space to change the number of topics, lower.thresh, and stopwords of questions to try to make a qualitatively better model after having inspecting/comparing the model in the STM viewer webapp. A good place to start is looking at how well defined the no/none topic is.</p>
<p>Be sure to write down the question number, best number of topics, and custom stop words</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="c1"># question index number to modify</span>
<span class="n">ntopics</span> <span class="o">&lt;-</span> <span class="m">17</span>
<span class="n">stop_words</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;art&#39;</span><span class="p">,</span><span class="s">&#39;arts&#39;</span><span class="p">)</span>

<span class="n">stm_settings</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">ntopics</span> <span class="o">&lt;-</span> <span class="n">ntopics</span>
<span class="n">stm_settings</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">stopwords</span> <span class="o">&lt;-</span> <span class="n">stop_words</span>

<span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">textProcessor</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">i</span><span class="p">]][[</span><span class="m">1</span><span class="p">]],</span> 
              <span class="n">metadata</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">i</span><span class="p">]][</span><span class="m">2</span><span class="p">],</span>
              <span class="n">customstopwords</span> <span class="o">=</span> <span class="n">stop_words</span><span class="p">)</span>

<span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span> <span class="o">&lt;-</span> <span class="nf">prepDocuments</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
              <span class="n">vocab</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">vocab</span><span class="p">,</span>
              <span class="n">meta</span> <span class="o">=</span> <span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">meta</span><span class="p">,</span>
              <span class="n">lower.thresh</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span> <span class="o">%&gt;%</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="m">1000</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span>

<span class="n">start</span> <span class="o">&lt;-</span> <span class="nf">Sys.time</span><span class="p">()</span>
<span class="n">stmobj</span> <span class="o">&lt;-</span> <span class="nf">stm</span><span class="p">(</span><span class="n">documents</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
                <span class="n">vocab</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">vocab</span><span class="p">,</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">ntopics</span><span class="p">,</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">meta</span><span class="p">,</span>
                <span class="n">verbose</span> <span class="o">=</span> <span class="bp">F</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">seed</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">Sys.time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

<span class="nf">save</span><span class="p">(</span><span class="n">stm_settings</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="s">&#39;stm_settings.rda&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Building corpus... 
Converting to Lower Case... 
Removing punctuation... 
Removing stopwords... 
Remove Custom Stopwords...
Removing numbers... 
Stemming... 
Creating Output... 
Removing 1571 of 2088 terms (2184 of 10266 tokens) due to frequency 
Removing 12 Documents with No Words 
Your corpus now has 1043 documents, 517 terms and 8082 tokens.Time difference of 4.885605 secs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set directory to save to</span>
<span class="n">directory</span> <span class="o">=</span> <span class="s">&#39;./&#39;</span>
<span class="c1"># names the json data.json</span>
<span class="n">datajson</span> <span class="o">=</span> <span class="kc">TRUE</span>

<span class="c1"># comment out one of the following 2 lines</span>
<span class="n">labels</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>
<span class="c1"># labels &lt;- read_json(&#39;labels/sr_othergrowth_labels.json&#39;)</span>

<span class="nf">if </span><span class="p">(</span><span class="nf">is.null</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">labels</span><span class="o">$</span><span class="n">topics</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>
    <span class="n">labels</span><span class="o">$</span><span class="n">clusters</span> <span class="o">&lt;-</span> <span class="kc">NULL</span>
<span class="p">}</span>

<span class="nf">for </span><span class="p">(</span><span class="n">threshold</span> <span class="n">in</span> <span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">0.1</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">possible_error</span> <span class="o">&lt;-</span> <span class="nf">tryCatch</span><span class="p">(</span>
      <span class="nf">create_json</span><span class="p">(</span>
        <span class="n">stm</span> <span class="o">=</span> <span class="n">stmobj</span><span class="p">,</span>
        <span class="n">documents_raw</span> <span class="o">=</span> <span class="n">questions</span><span class="p">[[</span><span class="n">i</span><span class="p">]][</span><span class="n">question_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">%&gt;%</span> <span class="nf">slice</span><span class="p">(</span><span class="o">-</span><span class="n">procs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">docs.removed</span><span class="p">)</span> <span class="o">%&gt;%</span> 
                                                               <span class="nf">slice</span><span class="p">(</span><span class="o">-</span><span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">docs.removed</span><span class="p">)</span> <span class="o">%&gt;%</span> 
                                                               <span class="n">pull</span><span class="p">,</span>
        <span class="n">documents_matrix</span> <span class="o">=</span> <span class="n">docs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]</span><span class="o">$</span><span class="n">documents</span><span class="p">,</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="n">question_names</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span>
        <span class="n">title</span> <span class="o">=</span> <span class="nf">names</span><span class="p">(</span><span class="n">questions</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
        <span class="n">clustering_thresh</span> <span class="o">=</span> <span class="n">threshold</span><span class="p">,</span>
        <span class="n">instant</span> <span class="o">=</span> <span class="n">datajson</span><span class="p">,</span>
        <span class="n">verbose</span> <span class="o">=</span> <span class="bp">T</span><span class="p">,</span>
        <span class="n">topic_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">$</span><span class="n">topics</span><span class="p">,</span>
        <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">labels</span><span class="o">$</span><span class="n">clusters</span><span class="p">,</span>
        <span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
    <span class="p">),</span> <span class="n">error</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="n">msg</span><span class="p">)</span>
    <span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">inherits</span><span class="p">(</span><span class="n">possible_error</span><span class="p">,</span> <span class="s">&quot;error&quot;</span><span class="p">))</span> <span class="n">break</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Performing hierarchical topic clustering ... 
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            kernelName: "ir",
            path: "./analysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="topics.html" title="previous page">Topic Modeling and Interpretation</a>
    <a class='right-next' id="next-link" href="dictionaries.html" title="next page">Dictionaries of Language Patterns</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-44678143-2', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>